<header>
  <%= link_to entries_path do %>
    <%= icon 'fab', 'instagram' %>
    <%= '|' %>
    <%= image_tag 'https://fontmeme.com/permalink/200109/23a93f3d238949f77b4e6ed79577bcc1.png', class: 'header_logo' %>
  <% end %>

  <%= link_to 'new post',new_entry_path %>

  <%= link_to user_path(current_user.id) do %>
    <%= icon 'far', 'user' %>
  <% end %>
</header>

<article class="entry_list">
  <% @entries.each do |entry| %>
    <div class="entry">
      <%= link_to user_path(entry.user_id) do %>
        <% if entry.user.user_image.blank? %>
          <%= icon 'fas', 'user-circle' %>
        <% else %>
          <%= image_tag entry.user.user_image.url %>
        <% end %>
        <%= entry.user.user_name %>
      <% end %>

      <%= link_to entry_path(entry.id), method: :delete, data: { confirm: '本当に削除してよろしいですか？' } do %>
        <%= icon 'fas', 'trash' %>
      <% end %>

      <div class="entry_image">
        <%= image_tag entry.image.url %>
      </div>

      <div class="entry_menu">
        <%= icon 'far', 'heart' %>
        <%= link_to entry_path(entry.id) do %>
          <%= icon 'far', 'comment' %>
        <% end %>
      </div>

      <% unless entry.content.blank? %>
        <div class="entry_content">
          <%= link_to user_path(entry.user_id) do %>
            <%= entry.user.user_name %>
          <% end %>
          <%= entry.content %>
        </div>
      <% end %>

      <% replies = @all_reply.where(entry_id: entry.id) %>
      <% unless replies.blank? %>
        <div class="replies">
          <% replies.each do |reply| %>
            <div class="reply_content">
              <%= link_to user_path(reply.entry.user_id) do %>
                <%= reply.entry.user.user_name %>
              <% end %>
              <%= reply.content %>
            </div>
          <% end %>
        </div>
      <% end %>

      <div class="entry_time">
        <%= time_ago_in_words(entry.created_at)+'前' %>
      </div>
    </div>

    <div class="reply_form">
      <%= form_with(model: @reply, local: true) do |f| %>
        <%= f.text_field :content, placeholder: 'コメントを追加...' %>
        <%= f.hidden_field :entry_id, value: entry.id %>
        <%= f.submit '投稿する' %>
      <% end %>
    </div>
  <% end %>
</article>

<div class="user_area">
  <%= link_to user_path(current_user.id) do %>
    <% if current_user.user_image.blank? %>
      <%= icon 'fas', 'user-circle' %>
    <% else %>
      <%= image_tag current_user.user_image.url %>
    <% end %>
  <% end %>
  <%= link_to user_path(current_user.id) do %>
    <%= current_user.user_name %>
  <% end %>
  <%= current_user.name %>
</div>
